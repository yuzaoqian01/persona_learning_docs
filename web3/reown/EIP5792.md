### 一、什么是 EIP-5792？

EIP-5792 是一个为以太坊生态设计的新标准，目的是：

- 让 DApp 与钱包之间有一个 **统一、现代化的接口**，不仅用于发送单笔交易，还支持批量调用（batched calls）、查看调用状态、能力检测等。 [thirdweb+1](https://blog.thirdweb.com/what-is-eip-5792-a-guide-to-ethereums-wallet-call-api/?utm_source=chatgpt.com)
- 通过新增 JSON-RPC 方法，如 `wallet_sendCalls`、`wallet_getCallsStatus`、`wallet_getCapabilities` 等，使钱包能被应用“请求”执行一系列操作（例如批准代币 → 兑换 →质押）作为一个逻辑流程，而不必用户操作多次或者失败。 [Ethereum Improvement Proposals+1](https://eips.ethereum.org/EIPS/eip-5792?utm_source=chatgpt.com)
- 支持智能合约钱包、账号抽象（如 ERC-4337）等先进用例，让 “钱包” 不只是简单的 轴私钥 + 交易工具，而是拥有能力检测、批量操作、赞助（paymaster）等。 [eco.com+1](https://eco.com/support/en/articles/11822779-understanding-eip-5792-the-wallet-call-api-revolutionizing-ethereum-transactions?utm_source=chatgpt.com)

------

### 二、为什么要有 EIP-5792？

当前以太坊/钱包交互存在几个痛点：

- 多步骤操作（例如「先批准代币」→「兑换」）往往需要用户**多次确认**、多笔交易，若其中一步失败则整个流程被打断。 [thirdweb+1](https://blog.thirdweb.com/what-is-eip-5792-a-guide-to-ethereums-wallet-call-api/?utm_source=chatgpt.com)
- 钱包的能力（是否支持批量、是否支持 gas 赞助、智能账户）在 DApp 中通常难以探测，导致开发者只能写「有能力」与「无能力」的两套逻辑，增加复杂度。 [thirdweb](https://blog.thirdweb.com/what-is-eip-5792-a-guide-to-ethereums-wallet-call-api/?utm_source=chatgpt.com)
- 用户体验差：需要确认多次、等待多笔交易、容易因为中间失败浪费 gas／时间。EIP-5792 提出通过批量提交、原子执行、状态检测等手段改善体验。 [eco.com](https://eco.com/support/en/articles/11822779-understanding-eip-5792-the-wallet-call-api-revolutionizing-ethereum-transactions?utm_source=chatgpt.com)

------

### 三、核心机制与新增方法

下面是该标准中最关键的方法及其功能：

| 方法                     | 功能简介                                                     |
| ------------------------ | ------------------------------------------------------------ |
| `wallet_getCapabilities` | 应用调用此方法询问钱包支持哪些能力（如 `atomic` 批量执行、`paymasterService` 赞助 gas 等）。 [eip5792.xyz+1](https://www.eip5792.xyz/getting-started?utm_source=chatgpt.com) |
| `wallet_sendCalls`       | 向钱包提交一批 “calls” （每个 call 指向一个合约调用或转账），可以指定 `atomicRequired`（如果为 true，钱包必须尝试原子执行）。 [Ethereum Improvement Proposals+1](https://eips.ethereum.org/EIPS/eip-5792?utm_source=chatgpt.com) |
| `wallet_getCallsStatus`  | 应用通过 batch ID 查询先前提交的 calls 的执行状态（pending、confirmed、reverted 等）。 [Ethereum Improvement Proposals+1](https://eips.ethereum.org/EIPS/eip-5792?utm_source=chatgpt.com) |
| `wallet_showCallsStatus` | 请求钱包 UI 显示该 batch 的执行状态，提升用户可见性。 [eip5792.xyz](https://www.eip5792.xyz/getting-started?utm_source=chatgpt.com) |

**重要字段说明**：

- `atomic`：表示钱包是否真正将这一批 calls 原子执行（即全部成功或全部失败），或仅顺序执行。若 `atomicRequired=true` 则钱包必须原子处理或拒绝。 [Ethereum Improvement Proposals](https://eips.ethereum.org/EIPS/eip-5792?utm_source=chatgpt.com)
- `capabilities`：描述钱包支持的特性。应用可据此调整是否使用批量或降级为普通交易流程。 [docs.dynamic.xyz](https://docs.dynamic.xyz/wallets/using-wallets/evm/eip-5792?utm_source=chatgpt.com)

------

### 四、典型使用场景

- **一键代币批准+兑换**：用户无需先「批准」再「兑换」，而是一键触发两步调用，如果钱包支持原子执行，只有两步都成功才完成。
- **批量 NFT 铸造/装备/上场**：游戏中用户可能一次进行多个链上操作（铸造、设定属性、加入房间），EIP-5792 让这些操作在一个 batch 中完成。
- **Gas 赞助（Paymaster）流程**：DApp 希望赞助用户操作时，检查钱包是否支持 `paymasterService` 能力，再提交带能力字段的 batch。 [thirdweb](https://blog.thirdweb.com/what-is-eip-5792-a-guide-to-ethereums-wallet-call-api/?utm_source=chatgpt.com)
- **智能账户 /账号抽象支持**：对于基于 ERC-4337 的智能账户，EIP-5792 提供标准化接口让 DApp 与钱包交互时不必关心内部实现。

------

### 五、兼容与回退策略

- 如果钱包不支持 EIP-5792 中的方法（例如 `wallet_sendCalls` 不可用），应用应有 fallback 机制，将 batch 拆成多笔使用传统 `eth_sendTransaction` 提交。 [Ethereum Improvement Proposals](https://eips.ethereum.org/EIPS/eip-5792?utm_source=chatgpt.com)
- 在 UI 上，应用应先调用 `wallet_getCapabilities` 判断钱包是否支持需要的能力（如批量执行／赞助），再决定是否展示「一键多操作」按钮或传统「一步一步」流程。

------

### 六、当前支持与进展

- 虽然 EIP-5792 已发布，但其支持仍在扩展中。部分钱包、SDK（如 thirdweb Connect SDK）已经实现支持。 [thirdweb docs](https://portal.thirdweb.com/changelog/wallet-call-api-eip-5792-support-in-the-connect-sdk?ref=blog.thirdweb.com&utm_source=chatgpt.com)
- 应用开发者可通过文档看到支持情况，并优先为支持了该提案的钱包提供优化体验。 [dynamic.xyz](https://www.dynamic.xyz/docs/wallets/using-wallets/evm/eip-5792?utm_source=chatgpt.com)

------

### 七、安全与隐私考虑

- 钱包必须保证 `batchId`（提交批量调用后返回的 ID）不可预测，以防应用推断其他用户交易。 [Ethereum Improvement Proposals](https://eips.ethereum.org/EIPS/eip-5792?utm_source=chatgpt.com)
- `wallet_getCallsStatus` 返回的能力信息不应泄露敏感用户数据，从而避免钱包被指纹化或泄露用户身份。 [Ethereum Improvement Proposals](https://eips.ethereum.org/EIPS/eip-5792?utm_source=chatgpt.com)

------

### 八、简要总结

EIP-5792 是以太坊钱包与 DApp 交互层面的一大进步，带來以下好处：

- 批量调用、原子执行、多调用流程变得可行。
- 钱包能力检测机制，让 DApp 可以智能化选择流程。
- 用户体验提升：更少确认、减少失败和重复操作。
- 支持账号抽象、智能账户未来范式。

### 九 、与其他标准的关系

| 标准                    | 关系                                                         |
| ----------------------- | ------------------------------------------------------------ |
| **EIP-1193**            | 扩展自它，添加新的 JSON-RPC 方法                             |
| **EIP-155 / EIP-1559**  | 不冲突，仅用于底层交易打包                                   |
| **ERC-4337**            | 结合使用时，wallet_sendCalls 可通过 Bundler 统一发送 UserOperation |
| **EIP-3074 / EIP-5003** | 可作为未来授权执行（AuthTx）的兼容层                         |
| **EIP-5792**            | 提供统一接口屏蔽底层实现差异                                 |